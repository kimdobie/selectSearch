
// Version 1.2.2 
// Date: 08/23/2010

jQuery.fn.selectSearch=function(e,c){return this.each(function(){var b=jQuery(this),a=jQuery(e),f=true,g=false,h=true,k=true,n=false,o=true,t=jQuery(this);if(c!=undefined){if(c.showEmptyOptGroup!=undefined&&typeof c.showEmptyOptGroup=="boolean")n=c.showEmptyOptGroup;if(c.selectLast!=undefined&&typeof c.selectLast=="boolean")f=c.selectLast;if(c.startSearchFromFront!=undefined&&typeof c.startSearchFromFront=="boolean")g=c.startSearchFromFront;if(c.fixedWidth!=undefined&&typeof c.fixedWidth=="boolean")o=
c.fixedWidth;if(c.sortOptions!=undefined&&typeof c.sortOptions=="boolean")h=c.sortOptions;if(c.sortOptGroups!=undefined&&typeof c.sortOptGroups=="boolean")k=c.sortOptGroups}o&&b.css("width",b.css("width"));$(this).attr("data-selectSearch-fromFront",g);a.val("");a.keyup(function(){jQuery(this).val();for(var d=true,i=[],l=selectSearch_Options.optionItems[b.attr("id")],p=cleanInput(a.val()),m=0;m<l.length;m++){i[m]=Array(l[m][0],[]);for(j=0;j<l[m][1].length;j++)(d=t.attr("data-selectSearch-fromFront")==
"true"?matchingFromStart(p,l[m][1][j].text):matching(p,l[m][1][j].text))&&i[m][1].push(l[m][1][j])}b.selectSearch_buildOptions(i,n);f&&b.find("option").length==1&&b.find("option").attr("selected","selected")});b.change(function(){jQuery(this).find("option").each(function(){jQuery(this).attr("selected")?checkIfInSelectedArray(jQuery(this).attr("value"),true,b):checkIfInSelectedArray(jQuery(this).attr("value"),false,b)})});checkIfInSelectedArray=function(d,i,l){var p=jQuery.inArray(d,selectSearch_Options.optionItems[l.attr("id")+
"_selected"]);if(p==-1&&i)selectSearch_Options.optionItems[l.attr("id")+"_selected"].push(d);else p!=-1&&!i&&selectSearch_Options.optionItems[l.attr("id")+"_selected"].splice(p,1)};cleanInput=function(d){d=d.replace("(","\\(");d=d.replace(")","\\)");d=d.replace("*","\\*");d=d.replace("+","\\+");d=d.replace("[","\\[");d=d.replace("]","\\]");d=d.replace("?","\\?");return d=d.replace("|","\\|")};if(b.attr("id")==""){b.attr("id","selectSearch_SelectList"+selectSearch_IDCounter);selectSearch_IDCounter++}b.attr("id");
var q=[];selectSearch_Options.optionItems[b.attr("id")+"_selected"]=[];var s=null,r=-1;b.children().each(function(){var d="",i=false;if(this.tagName.toLowerCase()=="optgroup"){d=jQuery(this).attr("label");i=true}if(s!=d){r++;s=d;q[r]=Array(d,[])}if(i)jQuery(this).children().each(function(){q[r][1].push({text:jQuery(this).text(),value:jQuery(this).attr("value")});jQuery(this).attr("selected")&&selectSearch_Options.optionItems[b.attr("id")+"_selected"].push(jQuery(this).attr("value"))});else{q[r][1].push({text:jQuery(this).text(),
value:jQuery(this).attr("value")});jQuery(this).attr("selected")&&selectSearch_Options.optionItems[b.attr("id")+"_selected"].push(jQuery(this).attr("value"))}});selectSearch_Options.optionItems[b.attr("id")]=q;b.selectSearch_sortOptions(k,h,n);matchingFromStart=function(d,i){return RegExp("^"+d+".*","i").test(i)};matching=function(d,i){return RegExp(d,"ig").test(i)}})};
jQuery.fn.selectSearch_buildOptions=function(e,c){jQueryselectList=jQuery(this);jQueryselectList.html("");var b=false;if(selectSearch_Options.optionItems[jQueryselectList.attr("id")+"_selected"]!=undefined)b=true;for(var a=0;a<e.length;a++){var f="";if(e[a][0]!=""&&(c||e[a][1].length>0))f+="<optgroup label='"+e[a][0]+"'>";for(var g=0;g<e[a][1].length;g++){f+="<option value='"+e[a][1][g].value+"'";if(b&&jQuery.inArray(e[a][1][g].value,selectSearch_Options.optionItems[jQueryselectList.attr("id")+"_selected"])!=
-1)f+="selected='selected' ";f+=">"+e[a][1][g].text+"</option>"}if(e[a][0]!=""&&(c||e[a][1].length>0))f+="</optgroup>";jQueryselectList.append(f)}return this};
jQuery.fn.selectSearch_sortOptions=function(e,c,b){selectItems=selectSearch_Options.optionItems[jQuery(this).attr("id")];e&&selectItems.sort(function(a,f){if(f[0].toLowerCase()<a[0].toLowerCase())return 1;return f[0].toLowerCase()>a[0].toLowerCase()?-1:0});if(c)for(e=0;e<selectItems.length;e++)selectItems[e][1].sort(function(a,f){if(f.text.toLowerCase()<a.text.toLowerCase())return 1;return f.text.toLowerCase()>a.text.toLowerCase()?-1:0});jQuery(this).selectSearch_buildOptions(selectItems,b);return this};
jQuery.fn.selectSearch_addOption=function(e,c,b,a){var f=true,g=true,h=true,k=null;if(a!=undefined){if(a.sortOptions!=undefined&&typeof a.sortOptions=="boolean")f=a.sortOptions;if(a.sortOptGroups!=undefined&&typeof a.sortOptGroups=="boolean")g=a.sortOptGroups;if(a.showEmptyOptGroup!=undefined&&typeof a.showEmptyOptGroup=="boolean")h=a.showEmptyOptGroup;if(a.searchBox!=undefined&&typeof a.searchBox=="object")k=a.searchBox}if(typeof b=="undefined")b="";a=selectSearch_Options.optionItems[jQuery(this).attr("id")];
for(var n=false,o=0;o<a.length&&!n;o++)if(b==a[o][0]){a[o][1].push({text:e,value:c});n=true}n||a.push(Array(b,Array({text:e,value:c})));jQuery(this).selectSearch_sortOptions(g,f,h);k!=null&&k.trigger("keyup");return this};
jQuery.fn.selectSearch_removeOption=function(e,c,b){if(c==undefined)c="";var a=true;if(b==undefined||b==""){b="";a=false}for(var f=selectSearch_Options.optionItems[jQuery(this).attr("id")],g=false,h=0;h<f.length&&!g;h++)if(b==f[h][0]||!a)for(var k=0;k<f[h][1].length&&!g;k++)if(f[h][1][k].text==e&&f[h][1][k].value==c){f[h][1].splice(k,1);g=true}if(a){b=jQuery(this).find('optgroup[label="'+b+'"]').eq(0);b.find('option[value="'+c+'"]:contains("'+e+'")').eq(0).remove();b.find("option").length==0&&b.remove()}else jQuery(this).find('option[value="'+
c+'"]:contains("'+e+'")').eq(0).remove();return this};jQuery.fn.selectSearch_startSearchFromFront=function(e){e==undefined||typeof e!="boolean"?alert("Please send a boolean to the \tselectSearch_startSearchFromFront method"):$(this).attr("data-selectSearch-fromFront",e)};function selectSearch_OptionsObject(){this.optionItems=[]}var selectSearch_Options=new selectSearch_OptionsObject,selectSearch_IDCounter=0;